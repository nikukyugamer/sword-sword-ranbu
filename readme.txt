==============
とうらぶキャプ
==============
「刀剣乱舞」の画面をキャプチャーする（スクショを撮る、スクリーンショットを撮る）ツールです。以下の「＜使い方＞」を読んでいただければ、最低限の利用をすることができます。

＜使い方＞
1.「初期設定」ボタンを押します。
2.「使用するWebブラウザ」にお使いのWebブラウザを選択します。
3.「撮影ファイルの保存場所」に撮影したファイルの保存場所が表示されていますが（デフォルトでは「マイドキュメント」）、変更したい場合は「保存場所変更」ボタンを押して変更します。
4.「閉じる」を押して初期設定を閉じます。
5.とうらぶを遊びます。
6.キャプチャーしたい場面で「撮影する」ボタンを押します。
7.「3.」で設定した保存場所に「TouLoveCap_20150214-073045.png」のようなファイル名でキャプチャした画像が保存されます（横960px、縦580px）。

＜使い方・補足＞
※「撮影ファイルの保存形式」にて保存されるファイルの形式を選択することができます。JPEGの保存品質はデフォルトの75になっています。
※「初期設定」で設定した設定内容は本ソフト終了時に保存されますので、変更が無ければ本ソフトを起動する度に改めて「初期設定」で設定をする必要はありません。
※設定内容が保存される場所は「\（ユーザーディレクトリ）\AppData\Local\@budehuc」ですので、不要であればこのフォルダごと削除して下さい（通常は削除の必要はありません）。
※設定内容は本ソフトの保存場所とともに記憶しているので、本ソフトの保存場所を変更した場合は新たに設定をし直す必要があります。

＜「詳細設定」メニューの項目について＞
「詳細設定」ボタンを押すたびに、詳細設定項目が表示/非表示になります。
A.「Copyrightを入れる」にチェックが入っている場合、画面右下のCopyright部分も含めてキャプチャします。
B.「撮影後に通知をする」にチェックが入っている場合、撮影が完了した後に「撮影が完了した」旨のメッセージが出ます。
C.「常に手前に表示」にチェックが入っている場合、本ソフトのウィンドウが常に最前面表示になります。
D.「高速モード」にチェックが入っている場合、画像を高速で撮影します。ただし、チェックが入っている最中はゲーム画面の位置をWebブラウザ内で動かしてはいけません。もし撮影画像がズレるようになった場合は、一度チェックを外してみて下さい。
E.「審神者を隠す」について
E-1.「本丸画面」にチェックが入っている場合、本丸画面の左上部分の「○○隊」の部分を黒塗りにします。
E-2.「戦績画面」にチェックが入っている場合、本丸の戦績画面での「審神者：○○」の部分を黒塗りにします。
E-3.「戦績画面のコメントも隠す」にチェックが入っている場合、本丸の戦績画面でのコメント部分を黒塗りにします。
E-4.「戦闘結果＆遠征結果画面」にチェックが入っている場合、「戦闘結果」または「遠征結果」画面での審神者を黒塗りにします。
※現状、単に特定箇所を黒塗りにしているだけですので、チェックが入っているとどのゲーム場面でも強制的に黒塗りになってしまいます。ご使用の際はご注意下さい。
※この項目についてはソフト終了時にチェックの有無を記憶しません。

＜「撮影ショートカットキー」について＞
「撮影ショートカットキー」を設定することで、その設定したキーを押すことにより撮影をすることができます。設定に際しては他のアプリケーションで使うキーと重複しないように注意して下さい。
「撮影ショートカットキー」を設定するには、まず「詳細設定」の中にある「撮影ショートカットキー設定」ボタンを押します。次に「撮影ショートカットキー」に設定したいキーをそこで直接入力して設定します。設定が終わったら「OK」を押します。
「撮影ショートカットキー」として設定できるキーの制限は以下のとおりです。
・Shift、Ctrl、Altのキーと、A～Zのキーの組み合わせであること。
・Shift、Ctrl、Altのキーは複数を同時に押す設定でも可能である。

＜現在までに分かっている制限など（対応検討中）＞
(1)WebブラウザやOSの「拡大」「縮小」機能を使って100%以外の表示倍率にしていると、正しくキャプチャできません（領域を960x580に固定しているためです）。
(2)使用するWebブラウザにゲーム画面全体が表示されていなければいけません。
(3)同じ日の同じ時間（秒まで一致）にファイルを保存すると、最後に保存されたファイルが上書きされます。
(4)IEとChromeとFirefoxにのみ対応しています。
(5)キャプチャする画像はゲーム画面全体です。
(6)まれに表示画面の横pxが579pxになって1px余ることがあります（白線になってしまう。原因不明。IEで起きやすい？）。
(7)ファイルの書き込み権限がない場所を保存場所に設定して「撮影する」ボタンを押すとエラーが出ます。
(8)画面をそのままキャプチャしていますので、「常に手前に表示」するウィンドウなどがゲーム画面にかぶる場合は、それも一緒にキャプチャしてしまいます。

＜今後の予定＞
(a)領域が正しく認識されない場合があればさらにアルゴリズムを洗練したい。
(b)エラー処理を追加したい。
(c)撮影ファイル名を任意に決められるようにしたい。

不具合報告や要望などをお待ちしております。

=================================================================
開発＆動作確認環境 : Windows 10 / Windows 8.1 / IE 11 / Chrome 53 / Firefox 48
Developed by @budehuc
メール : gregminster@obel.sakura.ne.jp
Webページ : http://www.harmonia.country/TouLoveCap/
=================================================================

＜改版履歴＞
Version 1.2.1.0 (2016/09/19)
ウェブページのタイトル部分で「DMM.com」であったものが「DMM GAMES」に変更されたことによるブラウザ不認識に対応。

Version 1.2.0.0 (2015/05/03)
ChromeとFirefoxで、「常に手前に表示」の機能が撮影後に無効になってしまう不具合を修正した。
コピーライトの部分のフォントサイズが大きくなったのに対応した。

Version 1.1.0.1 (2015/03/18)
デバッグ用ボタンが残ったままになっていたので撤去した。

Version 1.1.0.0 (2015/03/18)
とうらぶのページをIEのショートカットから開いた場合にウィンドウを正しく認識しない不具合を修正した（Thanks to Webページからのメッセージ）。

Version 1.0.0.1 (2015/03/14)
「高速モード」のコントロールにツールチップを追加した。

Version 1.0.0.0 (2015/03/08)
「高速モード」を実装した。

Version 0.9.9.0 (2015/03/04)
全Webブラウザにて撮影領域の取得アルゴリズムを強化し、撮影の失敗を無くした（Thanks to 春兎）。

Version 0.9.8.9 (2015/03/03)
領域取得に失敗した場合に警告メッセージを出してキャプチャをしないようにした。
各種情報メッセージのウィンドウ名を「とうらぶキャプ」に統一した。

Version 0.9.8.0 (2015/02/20)
メモリリークをしていた不具合を修正した。

Version 0.9.7.5 (2015/02/16)
バージョンアップ時に設定が引き継がれない不具合を再々修正した。

Version 0.9.7.3 (2015/02/16)
バージョンアップ時に設定が引き継がれない不具合を再修正した。

Version 0.9.7.2 (2015/02/16)
バージョンアップ時に設定が引き継がれない不具合を修正した。

Version 0.9.7.1 (2015/02/16)
用語の統一（「画像ファイルの保存形式」→「撮影ファイルの保存形式」）をした。

Version 0.9.7.0 (2015/02/15)
「画像ファイルの保存形式」としてJPEGも選べるようにした。

Version 0.9.6.1 (2015/02/15)
メインのウィンドウバーに表示される名称を「とうらぶキャプ」にした。

Version 0.9.6.0 (2015/02/14)
「撮影ショートカットキー」を任意に設定できるようにした（Thanks to 三柳）。
「初期設定」ウィンドウおよび「撮影ショートカットキー」ウィンドウの出現位置がソフト本体の中央位置になるようにした。

Version 0.9.5.1 (2015/02/11)
二重起動の判別をより厳格にした。

Version 0.9.5.0 (2015/02/11)
設定項目の増加に伴い、UIを一新した。
「撮影をする」ためのショートカットキーを追加した。
「審神者を隠す」チェックを整理し、「戦闘結果＆遠征結果画面」についても隠せるようにした。
「情報」メニューに「とうらぶキャプ配布ページへ」飛ぶメニューを追加した。

Version 0.9.3.1 (2015/02/08)
「常に手前に表示」にチェックが入っている際でも「環境設定」メニューは最前面に表示されるようにした

Version 0.9.3.0 (2015/02/04)
「審神者を隠す」メニューを追加した（Thanks to Webページからのメッセージ）

Version 0.9.2.1 (2015/02/04)
「環境設定」のボタンの文言を変えた
二重起動時の情報ウィンドウの出現タイプを変えた

Version 0.9.2.0 (2015/02/03)
2015/02/03のメンテナンス後の画面変更に伴い、「Copyrightを入れる」設定を追加した

Version 0.9.1.0 (2015/02/03)
アプリケーションのアイコンを変更した

Version 0.9.0.0 (2015/02/02)
「常に手前に表示」が有効でも、撮影時にのみウィンドウが隠れるようにした

Version 0.8.9.4 (2015/02/02)
Chromeでのキャプチャ時に縦が1px下にずれていたのを修正した

Version 0.8.9.3 (2015/02/02)
Internet Explorerの一部の環境で正しくウィンドウが認識できなかった問題を修正した（Thanks to 紅玉りんご）

Version 0.8.9.2 (2015/02/01)
再び修正に伴いテストコードのままリリースしてしまったのを緊急修正した（Firefox）

Version 0.8.9.1 (2015/02/01)
修正に伴いテストコードのままリリースしてしまったのを緊急修正した（Firefox）

Version 0.8.9.0 (2015/02/01)
一部の環境で正しくキャプチャ領域を認識できなかった問題をさらに修正した（Thanks to Helga）

Version 0.8.8.0 (2015/02/01)
一部の環境で正しくキャプチャ領域を認識できなかった問題を修正した（Thanks to Helga）

Version 0.8.7.0 (2015/02/01)
「撮影後に通知をする」機能を追加した（Thanks to Webページからのメッセージ）
「環境設定」ウィンドウからEscキーで抜けられるようにした

Version 0.8.6.0 (2015/02/01)
縦解像度が1080に満たないモニタを使用している場合にエラーが出て正常にキャプチャできなかった、致命的不具合を修正した（Thanks to 笹野）

Version 0.8.5.4
ソースコード内に不具合を起こしかねないテストコードが紛れていたので削除した

Version 0.8.5.3
バージョンアップ時に設定がクリアされてしまう不具合を修正した

Version 0.8.5.0
Firefoxの一部環境でのキャプチャ領域誤認識の問題を修正した（Thanks to Helga＆三柳）
併せて他のWebブラウザの場合でも領域認識のアルゴリズムをより厳密にした

Version 0.8.0.1
「常に手前に表示」と「高速モード（未実装）」のチェック設定もソフト終了時に保存するようにした

Version 0.8.0.0
UIを大幅に見直した（Thanks to Webページからのメッセージ）
設定内容を保存するようにした（Thanks to Webページからのメッセージ）
二重起動を抑制するようにした
本ファイル（readme.txt）の書式を変えてスリムにした

Version 0.7.6.2
フォームのデザインを微調整した

Version 0.7.6.1
対応フレームワークを .NET Framework 4 とした

Version 0.7.6.0
ファイル名の時間表記部分を強制的に2ケタにした
アセンブリ名を「TouLoveCap」から「とうらぶキャプ」に変更した

Version 0.7.5.0
IE、Chrome、Firefoxでのキャプチャアルゴリズムを統一した

Version 0.7.2.0
アプリケーション実行時のアイコンを変更した
Firefoxで一部画面が正しくキャプチャできない不具合を修正した

Version 0.7.0.0
Firefoxに対応した（つもり）

Version 0.6.7.0
「常に手前に表示」を追加した（Thanks to 三柳）
バージョン番号を内部表記に合わせた

Version 0.66
実行ファイル名を TouLoveCap.exe に変更した

Version 0.65
キャプチャのアルゴリズムを根本的に見直した
IEとChromeで正常にキャプチャできない不具合を修正した

Version 0.6
Chromeに対応した
デフォルトの保存場所をマイドキュメントにした

Version 0.5
キャプチャファイル名を日時を含んだものに変えた
メニューを暫定的に作った
ドキュメント（このファイル）を少し整備した
配布場所をさくらに変更した
